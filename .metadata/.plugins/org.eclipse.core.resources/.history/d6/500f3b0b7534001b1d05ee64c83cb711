package com.test.webPrac.util;

import java.security.KeyFactory;
import java.security.KeyPair;
import java.security.KeyPairGenerator;
import java.security.PrivateKey;
import java.security.PublicKey;
import java.security.spec.RSAPublicKeySpec;

import javax.crypto.Cipher;

// Reference -> https://vip00112.tistory.com/40 
public class RSAUtil {

	// 암호화에 필요한 객체들 생성
	private KeyPairGenerator generator;
	private KeyFactory keyFactory;
	private KeyPair keyPair;
	private Cipher cipher;

	public RSAUtil() {
		try {
			generator = KeyPairGenerator.getInstance("RSA");
			generator.initialize(1024);
			keyFactory = KeyFactory.getInstance("RSA");
			cipher = Cipher.getInstance("RSA");
		} catch (Exception e) {
			e.printStackTrace();
		}

	}
	
	// 새로운 키값을 가지는 RSA 생성
	public RSA creatRSA() {
		RSA rsa = null;
		try {
			keyPair = generator.generateKeyPair();
			
			PublicKey publickey = keyPair.getPublic();
			PrivateKey privatekey = keyPair.getPrivate();
			
			RSAPublicKeySpec publicSpec = keyFactory.getKeySpec(publickey, RSAPublicKeySpec.class);
			String modulus = publicSpec.getModulus().toString(16);
			String exponent = publicSpec.getPublicExponent().toString(16);
			rsa = new RSA(privatekey, modulus, exponent);	
			
		} catch (Exception e) {
			e.printStackTrace();
		}
		return rsa;
	}

	public static void main(String[] args) {
		RSAUtil rsa = new RSAUtil();
		
	}

	public KeyPairGenerator getGenerator() {
		return generator;
	}

	public void setGenerator(KeyPairGenerator generator) {
		this.generator = generator;
	}

	public KeyFactory getKeyFactory() {
		return keyFactory;
	}

	public void setKeyFactory(KeyFactory keyFactory) {
		this.keyFactory = keyFactory;
	}

	public KeyPair getKeyPair() {
		return keyPair;
	}

	public void setKeyPair(KeyPair keyPair) {
		this.keyPair = keyPair;
	}

	public Cipher getCipher() {
		return cipher;
	}

	public void setCipher(Cipher cipher) {
		this.cipher = cipher;
	}

}
